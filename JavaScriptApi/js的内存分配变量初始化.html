<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>内存分配</title>
	<script>
		/* JavaScript在定义变量时完成内存分配 */
		var n = 123; // 给数值变量分配内存
		var s = "azerty"; // 给字符型
		var o = {
			a: 1,
			b: null
		}; // 为对象及其包含变量分配内存
		var a = [1, null, "abra"]; // 为数组及其包含变量分配内存（就像对象）
		function f(a) {
			return a + 2;
		} // 为函数（可调用的对象）分配内存
		// 函数表达式也能分配一个对象
		window.onload = function () {
			var oDiv = document.getElementById("oDiv");
			oDiv.addEventListener('click', function () {
				oDiv.style.backgroundColor = 'blue';
			}, false);
		};

		// 通过函数调用的内存分配
		// 有些函数调用结果是分配对象内存
		var d = new Date();
		var e = document.createElement('div'); // 分配一个DOM元素
		// 有些方法分配新变量或者新对象
		var str = "azerty";
		var s2 = s.substr(0, 3); // s2 is a new string
		// 因为string是不变量，JavaScript 可能没有分配内存，但只是存储了0-3的范围
		var arr = ["ouais ouais", "nan nan"];
		var a2 = ["generation", "nan nan"];
		var a3 = arr.concat(a2); // 新数组中有连接数组arr和数组a2中的四个元素。

		/*
		 值的使用
		 使用值的过程实际上是对分配内存进行读取与写入的操作，这意味着可以写入一个变量或者一个对象的属性值，甚至传递函数的参数。

		 当内存不再需要使用时释放
		 大多数内存管理的问题都在这个阶段。在这里最艰难的任务是找到"所分配的内存确实已经不再需要了"。它往往要求开发人员来确定在程序中哪一块内存不再需要并且释放它。
		 高级语言解释器嵌入了"垃圾回收器"，主要工作是跟踪内存的分配和使用，以便当分配的内存不再使用时，自动释放它。
		 这个过程是一个近似的，因为要知道某块内存是否需要是无法判定的 (无法被某种算法所解决)。

		 垃圾回收
		 如上所述自动寻找是否一些内存"不再需要"的问题是无法判定的。因此，垃圾回收实现只能有限制的解决一般问题。
		 */
	</script>
</head>
<body>
<div id="oDiv"></div>
</body>
</html>